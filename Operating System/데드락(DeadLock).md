# 데드락 (Deadlock)

## 데드락이란?

> **Deadlock, 교착 상태**
> 두 개 이상의 프로세스나 스레드가 서로 자원을 얻지 못해서 다음 처리를 하지 못하는 상태
> 무한히 다음 자원을 기다리게 되는 상태
> 시스템적으로 한정된 자원을 여러 곳에서 사용하려고 할 때 발생한다.

## 데드락의 발생 조건

1. 상호 배제
	- 한 번에 프로세스 하나만 해당 자원을 사용할 수 있다. 사용 중인 자원을 다른 프로세스가 사용하려면 요청한 자원이 해제될 때까지 기다려야 한다.
2. 점유 대기
	- 자원을 최소한 하나 보유하고, 다른 프로세스에 할당된 자원을 점유하기 위해 대기하는 프로세스가 존재해야 한다.
3. 비선점
	- 이미 할당된 자원을 강제로 빼앗을 수 없다.
4. 순환 대기
	- 대기 프로세스의 집합이 순환 형태로 자원을 대기하고 있어야 한다.


## 데드락의 해결 방법

1. 데드락이 발생하지 않도록 예방(prevention) 하기
> 	- 상호배제 부정 : 여러 프로세스가 공유 자원 사용
>	- 점유대기 부정 : 프로세스 실행전 모든 자원을 할당
>	- 비선점 부정 : 자원 점유 중인 프로세스가 다른 자원을 요구할 때 가진 자원 반납
>	- 순환대기 부정 : 자원에 고유번호 할당 후 순서대로 자원 요구
2. 데드락 발생 가능성을 인정하면서도 적절하게 회피(avoidance) 하기
>	은행원 알고리즘(Banker's Algorithm)
>	- 은행에서 모든 고객의 요구가 충족되도록 현금을 할당하는데서 유래함
> - 프로세스가 자원을 요구할 때, 시스템은 자원을 할당한 후에도 안정 상태로 남아있게 되는지 사전에 검사하여 교착 상태 회피
> - 안정 상태면 자원 할당, 아니면 다른 프로세스들이 자원 해지까지 대기
3. 데드락 발생을 허용하지만 데드락을 탐지(detection)하여, 데드락에서 회복(Recovery)하기
> 1. 탐지 (Detection)
> 자원 할당 그래프를 통해 교착 상태를 탐지함
> 자원 요청 시, 탐지 알고리즘을 실행시켜 그에 대한 오버헤드 발생함
>
>2. 회복 (Recovery)
>교착 상태 일으킨 프로세스를 종료하거나, 할당된 자원을 해제시켜 회복시키는 방법
> - 프로세스 종료 방법
>  -- 교착 상태의 프로세스를 모두 중지
>  -- 교착 상태가 제거될 때까지 하나씩 프로세스 중지
>  
> - 자원 선점 방법
>  -- 교착 상태의 프로세스가 점유하고 있는 자원을 선점해 다른 프로세스에게 할당 (해당 프로세스 일시정지 시킴)
>  -- 우선 순위가 낮은 프로세스나 수행 횟수 적은 프로세스 위주로 프로세스 자원 선점


---
참고

https://chanhuiseok.github.io/posts/cs-2/
https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/DeadLock.md



	 



# 메모리 (Memory)

- 메인 메모리는 CPU가 직접 접근할 수 있는 기억 장치

- 프로세스가 실행되려면 프로그램이 메모리에 올라와야 한다.

- 주소가 할당된 일련의 바이트들로 구성되어 있다.

## MMU (Memory Management Unit, 메모리 관리 장치)

> CPU는 레지스터가 지시하는대로 메모리에 접근하여 다음에 수행할 명령어를 가져온다. 명령어 수행 시 메모리에 필요한 데이터가 없으면 해당 데이터를 우선 가져오는 역할을 한다.

-   논리 주소를 물리주소로 변환해 준다.
    
-   메모리 보호나 캐시 관리 등 CPU가 메모리에 접근하는 것을 총 관리해주는 하드웨어

메모리의 공간이 한정적이기 때문에, 사용자에게 더 많은 메모리를 제공하기 위해 '가상 주소'라는 개념이 등장 (가상 주소는 프로그램 상에서 사용자가 보는 주소 공간이라고 보면 됨)

이 가상 주소에서 실제 데이터가 담겨 있는 곳에 접근하기 위해선 빠른 주소 변환이 필요한데, 이를 MMU가 도와주는 것

즉, MMU의 역할은 다음과 같다고 말할 수 있다.

- MMU가 지원되지 않으면, physical address를 직접 접근해야 하기 때문에 부담이 있다.
 
- MMU는 사용자가 기억장소를 일일이 할당해야 하는 불편을 없애준다.
 
- 프로세스의 크기가 실제 메모리의 용량을 초과해도 실행될 수 있게 해준다.


또한 메인 메모리의 직접 접근은 비효율적이므로, CPU와 메인 메모리 속도를 맞추기 위해 캐시가 존재한다.

## MMU의 메모리 보호

프로세스는 독립적인 메모리 공간을 가져야 되고, 자신의 공간만 접근해야 한다.

따라서 한 프로세스에게 합법적인 주소 영역을 설정하고, 잘못된 접근이 오면 trap을 발생시키며 보호한다.

## 메모리 과활당 (Over Allocating)

실제 메모리의 사이즈보다 더 큰 사이즈의 메모리를 프로세스에 할당한 상황

페이지 기법과 같은 메모리 관리 기법은 사용자가 눈치 채지 못하도록 눈속임을 통해 메모리를 할당해준다. (가상 메모리를 이용해서)

  

과할당 상황에 대해서 사용자를 속인 것을 들킬만한 상황이 존재한다.

1.  프로세스 실행 도중 페이지 폴트 발생
2.  페이지 폴트를 발생시킨 페이지 위치를 디스크에서 찾음
3.  메모리의 빈 프레임에 페이지를 올려야 하는데, 모든 메모리가 사용중이라 빈 프레임이 없음

  

이러한 과할당을 해결하기 위해선, 빈 프레임을 확보할 수 있어야 한다.

1.  메모리에 올라와 있는 한 프로세스를 종료시켜 빈 프레임을 얻음
    
2.  프로세스 하나를 swap out하고, 이 공간을 빈 프레임으로 활용
    

  

swapping 기법을 통해 공간을 바꿔치기하는 2번 방법과는 달리 1번은 사용자에게 페이징 시스템을 들킬 가능성이 매우 높아서 하면 안된다.

(페이징 기법은 사용자 모르게 시스템 능률을 높이기 위해 선택한 일이므로 들키지 않게 처리해야한다)

  

따라서, 2번과 같은 해결책을 통해 페이지 교체가 이루어져야 한다.


## 캐시 메모리

- 주기억장치에 저장된 내용의 일부를 임시로 저장해두는 기억장치

- CPU와 주기억장치의 속도 차이로 성능 저하를 방지하기 위한 방법

- CPU가 이미 봤던걸 다시 재접근할 때, 메모리 참조 및 인출 과정에 대한 비용을 줄이기 위해 캐시에 저장해둔 데이터를 활용한다.

- 캐시는 플리플롭 소자로 구성되어 SRAM으로 되어있어서 DRAM보다 빠른 장점을 지닌다.

- 캐시를 잘 활용한다면 비용을 많이 줄일 수 있음

- 따라서 CPU가 어떤 데이터를 원할지 어느정도 예측할 수 있어야 함

적중률을 극대화시키기 위해 사용되는 것이 바로  `지역성의 원리`

지역성

> 기억 장치 내의 정보를 균일하게 액세스 하는 것이 아니라 한 순간에 특정부분을 집중적으로 참조하는 특성

  

지역성의 종류는 시간과 공간으로 나누어짐

- **시간 지역성**  : 최근에 참조된 주소의 내용은 곧 다음에도 참조되는 특성

- **공간 지역성**  : 실제 프로그램이 참조된 주소와 인접한 주소의 내용이 다시 참조되는 특성

---

참조

https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/Memory.md

# 파일 시스템 (File System)

- **파일(File)** : 논리적인 저장 단위로 관련된 정보 자료들의 집합에 이름을 붙인 것. 컴퓨터 시스템의 편리한 사용을 위해 저장의 일관된 논리적 관점을 제공한다.
- **파일 속성(File Attribute)** or **파일의 메타데이터(Metadata)** : 파일을 관리하기 위한 각종 정보들. 파일에 대한 전반적인 정보.
- **파일 시스템(File System)** : 운영체제와 모든 데이터, 프로그램의 저장과 접근을 위한 기법을 제공한다. 시스템 내의 모든 **파일에 관한 정보를 제공하는 계층적 디렉터리 구조이고, 파일 및 파일의 메타데이터, 디렉터리 정보 등을 관리**한다.
- **파티션(Partition)** : 연속된 저장 공간을 하나 이상의 연속되고 독립적인 영역으로 나누어 사용할 수 있도록 정의한 규약이다. 

<br />

## 파일 시스템의 개념

### 파일 시스템의 특징
- 커널 영역에서 동작
- 파일 CRUD 기능을 원활히 수행하기 위한 목적
- 계층적 디렉터리 구조를 가짐
- 디스크 파티션 별로 하나씩 둘 수 있음

### 파일 시스템의 역할
- 파일 관리
- 보조 저장소 관리
- 파일 무결성 메커니즘
- 접근 방법 제공

### 개발 목적
- 하드 디스크와 메인 메모리 속도차를 줄이기 위함
- 파일 관리
- 하드 디스크 용량 효율적 이용

### 구조
- 메타 영역 : 데이터 영역에 기록된 파일의 이름, 위치, 크기, 시간 정보, 삭제 유무 등의 파일 정보
- 데이터 영역 : 파일의 데이터

<br />

## 접근 방법

### 1. 순차 접근 (Sequential Access)

<img width="720" alt="f1" src="https://user-images.githubusercontent.com/38287375/176484920-854b1978-486e-48a9-b579-a5cffabc4a88.png">

가장 단순한 방법으로 파일의 정보가 레코드 순서대로 처리된다. 카세트 테이프를 사용하는 방식과 동일하다. 현재 위치에서 읽거나 쓰면 offset이 자동으로 증가하고, 뒤로 돌아가기 위해선 되감기가 필요하다.

### 2. 직접 접근 (Random Access)

<img width="712" alt="f2" src="https://user-images.githubusercontent.com/38287375/176488876-b79e444a-116a-44ae-8232-c4d2421ce882.png">

파일의 레코드를 임의의 순서로 접근할 수 있다. LP판을 사용하는 방식과 동일하다. 읽기나 쓰기의 순서에 제약이 없으며 현재 위치를 유지할 수 있다면 이를 통해 순차 접근 기능도 구현할 수 있다. 대규모 정보를 접근할 때 유용하기 때문에 '데이터베이스'에 활용된다.

### 3. 색인 접근 (Index Access)

<img width="728" alt="f3" src="https://user-images.githubusercontent.com/38287375/176489222-7c5b4d0f-3afd-40a3-a6cb-a23585ec92ef.png">

파일에서 레코드를 찾기 위해 색인을 먼저 찾고 대응되는 포인터를 얻는다. 이를 통해 파일에 직접 접근하여 원하는 데이터를 얻을 수 있다. 따라서 크기가 큰 파일에서 유용하다.

<br />

## 디렉터리 (Directory)

**디렉터리**는 파일의 메타데이터 중 일부를 보관하고 있는 일종의 특별한 파일이다.
해당 디렉터리에 속한 파일 이름과 속성들을 포함하고 있고, 다음과 같은 기능들을 제공한다.

-   파일 찾기(Search)
-   파일 생성(Create)
-   파일 삭제(Delete)
-   디렉터리 나열(List)
-   파일 재명명(Rename)
-   파일 시스템 순회(Traverse)

파일을 빠르게 탐색하고 또 적절한 이름으로 사용자들이 편리하게 사용할 수 있도록 파일들을 적절한 분류로 그룹화 해주는 논리적 구조를 정의하는 여러 방법들이 있다.


### 1. 1단계 디렉터리 (Single-Level Directory)

![f4](https://user-images.githubusercontent.com/38287375/176490147-753736db-5c5a-425e-96e2-fda882ae9a4c.png)

**모든 파일들이 디렉터리 밑에 존재하는 형태**

파일들을 서로 유일한 이름을 가짐. 서로 다른 사용자라도 같은 이름 사용 불가.

### 2. 2단계 디렉터리 (Two-Level Directory)

![f5](https://user-images.githubusercontent.com/38287375/176490457-fa76ecff-5709-4ec9-91eb-f36e54e16b66.png)

**각 사용자별로 별도의 디렉터리를 갖는 형태**

- UFD : 자신만의 사용자 파일 디렉터리
- MFD : 사용자의 이름과 계정 번호로 색인되어 있는 디렉터리. 각 엔트리는 사용자의 UFD를 가리킨다. 

서로 다른 사용자 같은 이름 파일 가질 수 있음. 효율적인 탐색 가능. 
그러나 그룹화 불가능함. 사용자의 파일에 접근해야 하는 경우에는 단점이 된다.

### 3. 트리 구조 디렉터리 (Tree-Structured Directory)

![f6](https://user-images.githubusercontent.com/38287375/176490876-b88b0ec2-03d7-444b-aaf8-d3e93fd2018a.png)

**사용자들이 자신의 서브 디렉터리를 만들어서 파일을 구성할 수 있다.**

하나의 루트 디렉터리를 가지며 모든 파일은 고유한 경로(절대/상대 경로)를 가진다. 
이를 통해 효율적인 탐색이 가능하고, 그룹화가 가능하다.

디렉터리는 일종의 파일이므로 일반 파일인지 디렉터리인지 구분할 필요가 있다. 
이를 bit를 사용하여 0이면 일반파일, 1이면 디렉터리로 구분한다.

### 4. 비순환 그래프 디렉터리 (Acyclic-Graph Directory)

![f7](https://user-images.githubusercontent.com/38287375/176491316-ec9f5a05-0d8e-4351-bc04-72bfe2e1cf9b.png)

**디렉터리들이 서브 디렉터리들과 파일을 공유할 수 있도록 한다.**

트리 구조의 디렉터리를 일반화한 형태이다.
단순한 트리 구조보다는 더 복잡한 구조이기 때문에 몇몇 문제가 발생할 수 있다.
파일을 무작정 삭제하게 되면 현재 파일을 가리키는 포인터는 대상이 사라지게 된다. 따라서 참조되는 파일에 참조계수를 두어서, 참조 계수가 0이 되면 파일을 참조하는 링크가 존재하지 않는다는 의미이므로 그때 파일을 삭제할 수 있도록 한다.

### 5. 일반 그래프 디렉터리 (General Graph Directory)

![f8](https://user-images.githubusercontent.com/38287375/176491667-ea5ee3a6-961a-479d-9f30-149de83dd99d.png)

**순환을 허용하는 그래프 구조**

순환이 허용되면 무한 루프에 빠질 수 있다.
따라서, 하위 디렉터리가 아닌 파일에 대한 링크만 허용하거나 Garbage Collection을 통해 전체 파일 시스템을 순회하고, 접근 가능한 모든 것을 표시한다.

<br />

---
참조

https://rebro.kr/181

https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/File%20System.md
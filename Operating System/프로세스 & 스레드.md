# 프로세스 & 스레드

**프로그램 -> 프로세스 -> 스레드**

**프로그램이란?**
 **파일이 저장 장치에 저장되어 있지만 메모리에는 올라가 있지 않은 정적인 상태**를 말한다.

1.  **메모리에 올라가 있지 않은:**  아직 운영체제가 프로그램에게 독립적인 메모리 공간을 할당해주지 않았다는 뜻이다. 모든 프로그램은 운영체제가 실행되기 위한 메모리 공간을 할당해 줘야 실행될 수 있다.
2.  **정적인 상태:**  정적(靜的)이라는 단어 그대로, 움직이지 않는 상태라는 뜻이다. 한 마디로 아직 실행되지 않고 가만히 있다는 뜻이다.

즉, **프로그램**이란 단어는 아직 실행되지 않은 파일 그 자체를 가리키는 말이다.
그리고 이 프로그램을 실행하는 것이 바로 **프로세스**이다. 프로세스의 코드에 정의된 절차에 따라 실행되는 특정한 수행 경로가 **스레드**이다.

요약 ) 
- **프로세스** : 운영체제로부터 자원을 할당받은 **작업**의 단위
- **스레드** : 프로세스가 할당받은 자원을 이용하는 **실행 흐름**의 단위


## 프로세스와 스레드의 작동 방식

![process](https://user-images.githubusercontent.com/38287375/168130741-27638a9d-49af-4eac-ae39-6d358e22bb64.png)

프로세스는 각각 별도의 주소공간을 할당한다. (독립적)

-   Code : 코드 자체를 구성하는 메모리 영역(프로그램 명령)
    
-   Data : 전역변수, 정적변수, 배열 등
    
    -   초기화 된 데이터는 data 영역에 저장
    -   초기화 되지 않은 데이터는 bss 영역에 저장
-   Heap : 동적 할당 시 사용 (new(), malloc() 등)
    
-   Stack : 지역변수, 매개변수, 리턴 값 (임시 메모리 영역)

스레드는 Stack만 따로 할당 받고 나머지 영역은 서로 공유한다.
하나의 프로세스가 생성될 때, 기본적으로 하나의 스레드도 같이 생성된다.

**프로세스는 자신만의 고유 공간과 자원을 할당 받아 사용**하는데 반해, **스레드는 다른 스레드와 공간, 자원을 공유하면서 사용**하는 차이가 있다.

## 멀티태스킹 & 멀티스레드

- **멀티태스킹** : 하나의 운영체제 안에서 여러 프로세스가 실행되는 것
- **멀티스레드** : 하나의 프로세스가 여러 작업을 여러 스레드를 사용하여 동시에 처리하는 것

**멀티스레드의 장점**
1.  Context-Switching할 때 공유하고 있는 메모리만큼의 메모리 자원을 아낄 수 있다.
2.  스레드는 프로세스 내의 Stack 영역을 제외한 모든 메모리를 공유하기 때문에 통신의 부담이 적어서 응답 시간이 빠르다.

**멀티스레드의 단점**

1.  스레드 하나가 프로세스 내 자원을 망쳐버린다면 모든 프로세스가 종료될 수 있다.
2.  자원을 공유하기 때문에 필연적으로  **동기화 문제**가 발생할 수밖에 없다.

## 결론

프로세스와 스레드는 개념의 범위부터 다르다. 스레드는 프로세스 안에 포함되어 있기 때문이다.

운영체제가 프로세스에게 Code/Data/Stack/Heap 메모리 영역을 할당해 주고 최소 작업 단위로 삼는 반면, 스레드는 프로세스 내에서 Stack 메모리 영역을 제외한 다른 메모리 영역을 같은 프로세스 내 다른 스레드와 공유한다.

프로세스는 다른 프로세스와 정보를 공유하려면 IPC를 사용하는 등의 번거로운 과정을 거쳐야 하지만, 스레드는 기본 구조 자체가 메모리를 공유하는 구조이기 때문에 다른 스레드와 정보 공유가 쉽다. 때문에 멀티태스킹보다 멀티스레드가 자원을 아낄 수 있게 된다. 다만 스레드의 스케줄링은 운영체제가 처리하지 않기 때문에 프로그래머가 직접 동기화 문제에 대응할 수 있어야 한다.

---
참조

https://velog.io/@raejoonee/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%B0%A8%EC%9D%B4

https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/Process%20vs%20Thread.md
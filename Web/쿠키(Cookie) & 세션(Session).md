# 쿠키(Cookie) & 세션(Session)

클라이언트 단위로 상태 정보를 유지해야 하는 경우 **쿠키(Cookie)** 와 **세션(Session)** 이 사용된다.
(Http protocol의 특징을 보완하기 위해 사용)

<br />

## 쿠키와 세션의 차이

| | 쿠키(Cookie) | 세션(Session) |
|-----|-----|-----|
| 저장 위치 | Client의 컴퓨터 | Server의 메모리 |
| 저장 형식 | Text | Object |
| 만료 시점 | 쿠키 저장시 설정 (설정 없으면 브라우저 종료 시) | 정확한 시점 알 수 없음 |
| 리소스 | 클라이언트의 리소스 | 서버의 리소스 |
| 용량 제한 | 한 도메인당 20개, 한 쿠키당 4KB | 제한없음 |
| 사용 예 | 아이디 저장, 최근 본 상품 목록 | 로그인 시 사용자 정보, 장바구니 등 |


<br />

## 쿠키 (Cookie)

> 서버에서 사용자의 컴퓨터(로컬)에 저장하는 정보 파일
>
> key와 value로 구성되고 String 형태로 이루어져 있다.
>
> 브라우저마다 저장되는 쿠키는 다르다.

### 쿠키의 사용 목적

- 세션 관리 : 사용자 아이디, 접속시간 등의 서버가 알아야 할 정보 저장
- 개인화 : 사용자마다 다르게 그 사람에 적절한 페이지를 보여줄 수 있다.
- 트래킹 : 사용자의 행동과 패턴을 분석하고 기록

### 쿠키의 구성 요소

- 이름 : 여러 개의 쿠키가 client의 컴퓨터에 저장되므로 각 쿠키를 구별하는 데 사용되는 이름
- 값 : 쿠키의 이름과 매핑되는 값
- 유효 기간 : 쿠키의 유효 기간
- 도메인 : 쿠키를 전송할 도메인
- 경로(path) : 쿠키를 전송할 요청 경로

### 쿠키의 동작 순서

1. 클라이언트가 페이지를 요청
2. WAS는 Cookie를 생성
3. HTTP header에 Cookie를 넣어 응답
4. Browser는 넘겨받은 Cookie를 PC에 저장하고 다시 WAS가 요청할 때 요청과 함께 Cookie를 전송
5. Browser가 종료되어도 Cookie의 만료 기간이 남아있다면 클라이언트는 계속 보관
6. 동일 사이트 재방문시 클라이언트의 PC에 해당 Cookie가 있는 경우 요청 페이지와 함께 Cookie를 전송

### 쿠키의 사용 예

- 사용자 아이디 (자동 로그인)
- 일주일간 다시 보지 않기
- 최근 검색한 상품
- 장바구니 기능

<br />

## 세션 (Session)

> 방문자가 웹 서버에 접속해 있는 상태를 하나의 단위로 보고 그것을 세션이라 한다.
>
>WAS의 memory에 Object 형태로 저장
>
> memory사 허용하는 용량까지 제한 없이 저장 가능

### 세션의 특징

- 웹 서버에 웹 컨테이너의 상태를 유지하기 위한 정보를 저장
- 웹 서버에 저장되는 쿠키
- 브라우저를 닫거나, 서버에서 세션을 삭제했을 때만 삭제가 되므로 쿠키보다 비교적 보안이 좋다.
- 각 클라이언트 고유 session id를 부여한다.
- session id로 클라이언트를 구분하여 각 클라이언트 요구에 맞는 서비스 제공


### 세션의 동작 순서

1. 클라이언트가 페이지를 요청
2. 서버는 접근한 클라이언트의 Request-header 필드인 Cookie를 확인하여 클라이언트가 해당 Session-id를 보냈는지 확인
3. Session-id가 존재하지 않는다면 서버는 Session-id를 쿠리를 사용해 서버에 저장. 쿠키 이름 : jsessionid
4. 클라이언트는 재 접속시, 이 쿠키를 이용하여 session-id값을 서버에 전달



### 세션의 사용 예

- 사이트 내에서 화면을 이동해도 로그인(사용자 정보)가 풀리지 않고 유지
- 장바구니 기능


---

참조

https://seco-log.tistory.com/83?category=973804
